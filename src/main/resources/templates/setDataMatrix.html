<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Set Data Matrix</title>
    <link rel="stylesheet" th:href="@{/style.css}">
</head>
<body>
<!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å –∫–Ω–æ–ø–∫–∞–º–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ -->
<div class="buttons-container">
    <!-- –ö–Ω–æ–ø–∫–∞ –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É -->
    <a th:href="@{/}"><button>–ì–ª–∞–≤–Ω–∞—è</button></a>
</div>

<!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ñ–æ—Ä–º—ã -->
<div class="form-container">
    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã -->
    <h2>–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥–æ—Å—Ç—É–ø—ã –∏–∑ –≤–Ω–µ—à–Ω–µ–≥–æ —Ñ–∞–π–ª–∞</h2>

    <!-- –ë–ª–æ–∫ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —É—Å–ø–µ—à–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π -->
    <div th:if="${successMessage}" class="alert alert-success">
        <span th:text="${successMessage}"></span>
    </div>

    <!-- –ë–ª–æ–∫ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π –æ–± –æ—à–∏–±–∫–∞—Ö -->
    <div th:if="${errorMessage}" class="alert alert-error">
        <span th:text="${errorMessage}"></span>
    </div>

    <!-- –§–æ—Ä–º–∞ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–æ–≤ -->
    <form th:action="@{/setDataMatrix}" method="post">
        <button type="submit" class="btn-primary">–ó–∞–≥—Ä—É–∑–∏—Ç—å –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø—ã</button>
    </form>

    <!-- –°–µ–∫—Ü–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø—Ä–æ–≤–µ—Ä–∫–∏ -->
    <div th:if="${result}" class="results-section">
        <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏:</h3>

        <!-- –§–æ—Ä–º–∞ –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π -->
        <!-- –î–æ–ª–∂–Ω–∞ –æ—Ö–≤–∞—Ç—ã–≤–∞—Ç—å –í–°–ï checkbox'—ã -->
        <form th:action="@{/setDataMatrix/apply}" method="post" id="applyForm">

            <!-- –°–µ–∫—Ü–∏—è –æ—à–∏–±–æ–∫ –∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π -->
            <!-- –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è, –µ—Å–ª–∏ –µ—Å—Ç—å –æ—à–∏–±–∫–∏ —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏–ª–∏ —Ñ–∞–π–ª–∞–º–∏ -->
            <div th:if="${result.hasMissingUserErrors() or result.hasMissingFileErrors()}" class="errors-section">
                <h4>‚ùå –û—à–∏–±–∫–∏ –∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è:</h4>

                <!-- –ü–æ–¥—Å–µ–∫—Ü–∏—è –¥–ª—è –æ—à–∏–±–æ–∫ —Å –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ -->
                <!-- –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è, –µ—Å–ª–∏ –µ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –≤ –º–∞—Ç—Ä–∏—Ü–µ -->
                <div th:if="${result.hasMissingUserErrors()}" class="missing-errors-section">
                    <h5>–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏:</h5>
                    <div class="corrections-list">
                        <!-- –¶–∏–∫–ª –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–∞–∂–¥–æ–π –æ—à–∏–±–∫–∏ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º -->
                        <div th:each="error, status : ${result.missingUserErrors}" class="correction-item">
                            <!-- Checkbox –¥–ª—è –≤—ã–±–æ—Ä–∞ —ç—Ç–æ–π –æ—à–∏–±–∫–∏ –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è -->
                            <input type="checkbox"
                                   th:name="correctionsToApply"
                                   th:value="${result.missingUserCorrections[status.index]}"
                                   checked>
                            <!-- –¢–µ–∫—Å—Ç –æ—à–∏–±–∫–∏ -->
                            <span th:text="${error}" class="error-text"></span>
                        </div>
                    </div>
                </div>

                <!-- –ü–æ–¥—Å–µ–∫—Ü–∏—è –¥–ª—è –æ—à–∏–±–æ–∫ —Å –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–º–∏ —Ñ–∞–π–ª–∞–º–∏ -->
                <!-- –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è, –µ—Å–ª–∏ –µ—Å—Ç—å —Ñ–∞–π–ª—ã, –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –≤ –º–∞—Ç—Ä–∏—Ü–µ -->
                <div th:if="${result.hasMissingFileErrors()}" class="missing-errors-section">
                    <h5>–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ —Ñ–∞–π–ª—ã:</h5>
                    <div class="corrections-list">
                        <!-- –¶–∏–∫–ª –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–∞–∂–¥–æ–π –æ—à–∏–±–∫–∏ —Å —Ñ–∞–π–ª–æ–º -->
                        <div th:each="error, status : ${result.missingFileErrors}" class="correction-item">
                            <!-- Checkbox –¥–ª—è –≤—ã–±–æ—Ä–∞ —ç—Ç–æ–π –æ—à–∏–±–∫–∏ –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è -->
                            <input type="checkbox"
                                   th:name="correctionsToApply"
                                   th:value="${result.missingFileCorrections[status.index]}"
                                   checked>
                            <!-- –¢–µ–∫—Å—Ç –æ—à–∏–±–∫–∏ -->
                            <span th:text="${error}" class="error-text"></span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- –°–µ–∫—Ü–∏—è —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–π –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
            <!-- –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è, –µ—Å–ª–∏ –µ—Å—Ç—å —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è –≤ –ø—Ä–∞–≤–∞—Ö –¥–æ—Å—Ç—É–ø–∞ -->
            <div th:if="${result.hasCorrections()}" class="corrections-section">
                <h4>üîß –†–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:</h4>
                <div class="corrections-list">
                    <!-- –¶–∏–∫–ª –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–∞–∂–¥–æ–≥–æ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è -->
                    <div th:each="correction, status : ${result.corrections}" class="correction-item">
                        <!-- Checkbox –¥–ª—è –≤—ã–±–æ—Ä–∞ —ç—Ç–æ–≥–æ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è -->
                        <input type="checkbox"
                               th:name="correctionsToApply"
                               th:value="${result.correctionsToApply[status.index]}"
                               checked>
                        <!-- –¢–µ–∫—Å—Ç —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è -->
                        <span th:text="${correction}" class="correction-text"></span>
                    </div>
                </div>
            </div>

            <!-- –ë–ª–æ–∫ —Å –∫–Ω–æ–ø–∫–∞–º–∏ –¥–µ–π—Å—Ç–≤–∏–π -->
            <!-- –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è, –µ—Å–ª–∏ –µ—Å—Ç—å —á—Ç–æ –ø—Ä–∏–º–µ–Ω—è—Ç—å: –ª–∏–±–æ –æ–±—ã—á–Ω—ã–µ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è, –ª–∏–±–æ –æ—à–∏–±–∫–∏ -->
            <div th:if="${result.hasItemsToApply() or result.hasMissingUserCorrections() or result.hasMissingFileCorrections()}"
                 class="apply-form-section">
                <h4>–ü—Ä–∏–º–µ–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è:</h4>
                <div class="actions">
                    <!-- –ö–Ω–æ–ø–∫–∞ –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π -->
                    <button type="submit" class="btn-apply">–ü—Ä–∏–º–µ–Ω–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
                    <!-- –ö–Ω–æ–ø–∫–∞ –¥–ª—è –≤—ã–±–æ—Ä–∞ –≤—Å–µ—Ö checkbox'–æ–≤ -->
                    <button type="button" onclick="selectAll()" class="btn-secondary">–í—ã–±—Ä–∞—Ç—å –≤—Å–µ</button>
                    <!-- –ö–Ω–æ–ø–∫–∞ –¥–ª—è —Å–Ω—è—Ç–∏—è –≤—Å–µ—Ö –≤—ã–±–æ—Ä–æ–≤ -->
                    <button type="button" onclick="deselectAll()" class="btn-secondary">–°–Ω—è—Ç—å –≤—Å–µ</button>
                </div>
            </div>
        </form>

        <!-- –°–µ–∫—Ü–∏—è —É—Å–ø–µ—à–Ω–æ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ -->
        <!-- –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è, –µ—Å–ª–∏ –≤—Å–µ –¥–æ—Å—Ç—É–ø—ã —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ -->
        <div th:if="${result.corrections.size() == 1 and result.corrections[0].contains('–í—Å–µ –¥–æ—Å—Ç—É–ø—ã')}" class="success-section">
            <h4>‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞:</h4>
            <p th:text="${result.corrections[0]}" class="success-text"></p>
        </div>

        <!-- –°–µ–∫—Ü–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π -->
        <!-- –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π -->
        <div th:if="${appliedCorrections}" class="applied-section">
            <h4>‚úÖ –ü—Ä–∏–º–µ–Ω–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:</h4>
            <ul>
                <!-- –¶–∏–∫–ª –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–Ω–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è -->
                <li th:each="applied : ${appliedCorrections}" th:text="${applied}"></li>
            </ul>
        </div>
    </div>
</div>

<!-- JavaScript —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è checkbox'–∞–º–∏ -->
<script>
    /**
     * –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—ã–±–æ—Ä–∞ –≤—Å–µ—Ö checkbox'–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
     * –ü—Ä–æ—Ö–æ–¥–∏—Ç –ø–æ –≤—Å–µ–º —ç–ª–µ–º–µ–Ω—Ç–∞–º input —Ç–∏–ø–∞ checkbox –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∏–º —Å–≤–æ–π—Å—Ç–≤–æ checked = true
     */
    function selectAll() {
        document.querySelectorAll('input[type="checkbox"][name="correctionsToApply"]').forEach(checkbox => {
            checkbox.checked = true;
        });
    }

    /**
     * –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–Ω—è—Ç–∏—è –≤—Å–µ—Ö –≤—ã–±–æ—Ä–æ–≤ —Å checkbox'–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
     * –ü—Ä–æ—Ö–æ–¥–∏—Ç –ø–æ –≤—Å–µ–º —ç–ª–µ–º–µ–Ω—Ç–∞–º input —Ç–∏–ø–∞ checkbox –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∏–º —Å–≤–æ–π—Å—Ç–≤–æ checked = false
     */
    function deselectAll() {
        document.querySelectorAll('input[type="checkbox"][name="correctionsToApply"]').forEach(checkbox => {
            checkbox.checked = false;
        });
    }
</script>
</body>
</html>